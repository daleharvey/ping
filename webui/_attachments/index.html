<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>CouchPotato</title>

    <style type="text/css">
      body, p, td { font-size:11px; font-family:sans-serif; }
    </style>

  </head>

  <body>

    <div id="placeholder" style="width:600px;height:300px;"></div>

    <script src="./js/jquery-1.6.min.js"></script>
    <script src="./js/jquery.couch.js"></script>
    <script src="./js/handlebars.1.0.0.beta.3.js"></script>
    <script src="./js/date.js"></script>
    <script src="./js/router.js"></script>
    <script src="./js/jquery.flot.js"></script>

<script type="text/javascript">

  var router = Router();
  var $db = $.couch.db("ping");

  router.get(/^(#)?$/, function (rtr) {
    $db.view("webui/browsers", {group:true}).then(function(data) {
      drawGraph(data);
    });
  });

  function drawGraph(data) {
    var graphData = [];
    $.each(data.rows, function(index, val) {
      graphData.push({label:val.key.join(" "), data:[[index, val.value]]});
    });

    $.plot($("#placeholder"), graphData, {bars: { show: true}});
  }

  router.init(window);

</script>

  </body>

</html>
